\chapter{Rendre visible : quantifier les choix éthiques}
\label{chapter:modelisation}
\newrefsegment
\PEEL{Les différents choix de modélisation abordés plus haut ont une variation sur le niveau de dommage importantes, presque aussi / plus importante que d'autres facteurs souvent pris en compte (incertitude, scénario climatique).}{On utilise une analyse économétrique pour essayer de quantifier ce phénomène. }{Même si les résultats ne sont pas super forts, on voit qu'il y a une variation importante qui est issue de la variation de ces paramètres éthiques.}{Le modèle ne donne pas de vérité absolue, il sort ce qu'on y a fait entrer => les modèles sont profondément politiques, et reflètent en ce sens une certaine conception du monde.}




\chapterabstract{Ce chapitre propose une approche plus économétrique des effets de la modélisation des fonctions de dommage. On utilise le modèle WILIAM, qui pourrait devenir un modèle de référence de la commission européenne, auquel on change les fonctions de dommage. On le fait tourner avec de nombreux scénarios, pour obtenir des résultats. On réalise ensuite une étude économétrique de ces résultats, pour savoir qu'elle paramètre a le plus d'effet sur les résultats du modèle.}

\newpage

%\cite{errickson_equity_2021} => il peut y avoir une plus grande variation du SCC selon l'équité que selon l'incertitude climatique

Nous avons vu dans le chapitre précédent que les modèles varient dans leurs choix de représentations des dommages. De plus, ces différents choix semblent tous valables à leur manière : les phénomènes représentés sont incertains, et cette variabilité représente surtout l'incertitude qui entoure ces phénomènes. Pourtant, ce sont bien les mêmes phénomènes; il ne devrait donc pas y avoir de différence entre les modèles. Ces différences sont donc apportées exclusivement par les choix de modélisation; or, elles peuvent être importantes, et donner des conclusions radicalement différentes, donnant lieu à des interprétations opposées. La querelle entre Nordhaus et Stern, évoquée plus haut, en est un exemple éloquent. 

Il est donc intéressant de voir dans quelle mesure ces variations influencent le comportement du modèle. En effet, si elles sont peu importantes comparées à d'autres facteurs, elles ne compromettent pas le message du modèle. En revanche, si elle joue un rôle central dans le fonctionnement de celui-ci, alors il convient de leur accorder une place majeure, tant dans l'analyse des résultats que dans la conception. 

\begin{figure}
    \centering
    \includegraphics[width=\linewidth]{results/carte_progressive.png}
    \legende{Double progression du niveau de dommage}{Le niveau de dommage suit une double progression. Chaque ligne correspond à une décennie; chaque colonne correspond à une fonction de dommage. D'une part, il augmente avec le temps (qui est lui même très lié au niveau de réchauffement); d'autre part, il augmente avec le modèle : certains modèles donnent des niveaux de dommage plus importants que d'autres. On voit ici a quel point les variables méthodologique (en l'occurence, le choix de la fonction de modèle) impactent le niveaux de dommage, d'une manière presque aussi importante que l'augmentation de la température.}
    \label{fig:carte-progressive}
\end{figure}

On cherche donc à mesurer quantitativement les effets de ces variables sur les résultats du modèle pour répondre à la question suivante : les variations induites par les choix éthiques sont-elles du même ordre de grandeur que les variations issues de variables physiques ou de choix de modélisation ? 



On définit ici la notion de paramètre éthique : elle désigne les paramètres qui n'ont pas vocation à représenter un phénomène physique ou social observable, mais plutôt à représenter une valeur morale. Le taux d'actualisation, par exemple, entre tout à fait dans cette définition. En effet, il représente l'importance accordée à l'équité intergénérationnelle. bien qu'il y ait eu des tentatives d'observer empiriquement cette valeur, notamment en s'intéressant au taux de préférence pure pour le présent dans les prêts de long terme, il semble difficile de penser que cette valeur soit valable à plus long terme ou dans d'autres contextes. Plutôt, il apparait que ce paramètre reflète un système normatif, et relève de ce fait plutôt du choix moral que du choix technique. Se pose alors la question suivante : quelle part de la variation du niveau total de dommage est-elle expliquée par ces paramètres éthiques.  On s'intéressera ici à une autre dimension éthique, qui est celle de l'équité spatiale. Pour ce faire, on construit un pondérateur géographique, qui pondère le niveau de dommage par région selon le niveau de revenu.

Dans cette partie, on développe un protocole expérimental qui vise à mesurer le niveau de dommage produit par différents modèles, différentes fonctions de dommages et des variations du pondérateur géographique. On régresse ensuite les données obtenues pour mesurer quantitativement la part de la variation qui est expliquée par ces différents paramètres. 

\section{Cadre conceptuel}

Le cadre conceptuel général de cette expérience est celui de la modélisation intégrée. Il s'inscrit en cela dans la lignée des réflexions développées dans le chapitre \ref{chapter:introduction}. Il semble néanmoins nécessaire de préciser quelques points. \\

\subsection{Choix du modèle}

D'abord, le choix du modèle. Pour réaliser cette expérience, nous avons choisi d'utiliser le modèle WILIAM, pour plusieurs raisons. 

\paragraph{Modèle Open-source} WILIAM est un modèle Open-Source, ce qui signifie que l'ensemble du code source est disponible en ligne, avec une licence permettant une utilisation, diffusion et modification du programme sans limites. C'est nécessaire puisqu'on a ainsi accès à tout le code source, ce qui permet de travailler sur une base solide; on peut également le modifier librement, ce qui est au cœur de l'expérience; enfin, on peut le diffuser librement aussi, ce qui est fait à travers le dépôt GitHub et le blog. Par ailleurs, bien que ce ne soit pas en soi une garantie de qualité, l'utilisation de l'open source permet d'améliorer la robustesse et la transparence des modèles, puisque chacun peut voir les hypothèses, proposer des modifications, et corriger des erreurs. 

\paragraph{Application aux politiques publiques} WILIAM est issu du projet LOCOMOTION, financé par la Commission Européenne. Il répond à une demande de celle-ci de s'équiper d'un nouveau modèle. Ainsi, WILIAM est un modèle qui vise à répondre à des questions de politique publique. 

\paragraph{Modèle complexe} WILIAM est un modèle particulièrement complexe : il compte près de 4 000 variables. Cela le rend particulièrement vulnérable aux problématiques de transparence et de complexité excessive que nous développerons plus tard. Néanmoins, cela nous permet d'avoir un modèle le plus complet possible. Cela permet d'intégrer les fonctions de dommage facilement, car les variables sont déjà existantes. 

\paragraph{Modèle de simulation} WILIAM est un modèle de simulation. Cette caractéristique est importante car elle permet de voir les valeurs de chaque paramètre à tout moment, mais aussi de représenter des paramètres non monétaires. De plus, ça le rend moins sensible aux critiques de normativité inhérente aux modèles d'optimisation. 

% \section{Présentation des données}


\section{Méthode}

\subsection{Données}


\begin{methodbox}[Modélisation des fonctions de dommage dans WILIAM]

Pour modéliser les fonctions de dommage dans WILIAM, on commence par créer un nouveau repo sur GitHub, dans lequel on télécharge le code source de WILIAM. On s'assure que tout est fonctionnel, et que le modèle tourne bien. La visualisation du modèle se fait grâce au logiciel VENSIM. \\

On rassemble les sources de données disponibles des modèles : code source, documentation et / ou publications qui y font référence. Ces sources n'offrent pas le même niveau d'information. Par exemple, les modèles dont on ne trouve pas le code source mais uniquement des publications sont plus difficiles à modéliser car il manque souvent des informations cruciales, telles que les valeurs obtenues pour les paramètres. \\

Une fois la définition de la fonction identifiée, on les modélise à l'aide de l'interface graphique du logiciel VENSIM. On sauvegarde régulièrement en réalisant des \textit{commit} sur GitHub pour garder une trace de la progression.
    
\end{methodbox}

\begin{methodbox}[Conversion des paramètres selon les bonnes zones géographiques]

    Le modèle WILIAM comporte 35 régions. En revanche, les autres modèles n'ont pas nécessairement le même découpage géographique. Deux cas se distinguent : soit le modèle est agrégé au niveau mondial; on peut alors utiliser les fonctions de dommage région par région, sans besoin de les changer. Soit le modèle possède des régions, et il faut alors convertir les régions du modèle A en régions de WILIAM pour avoir la bonne paramétrisation. Ce deuxième cas de figure est particulièrement vrai dans le cas du modèle FUND, qui a des régions très différentes de celles de WILIAM, et qui repose beaucoup sur de la paramétrisation. Il faut donc convertir les paramètres des régions de FUND en régions de WILIAM. 

    Par ailleurs, il est à noter que si la documentation de FUND est très complète et accessible en ligne, les tables de paramètre ne sont pas disponibles dans un format facilement lisible tel que CSV. La méthode retenue a été de lire la page de la documentation (en Markdown), et de la découper table par table, puis valeur par valeur à l'aide d'un script python, qui permet ensuite d'enregistrer ces données dans un format lisible par VENSIM. Ces opérations sont longues et peuvent être source de nombreuses erreurs. Ainsi, le non-partage des données dans un format standard est un vrai frein à la reproductibilité. \\
    
    On utilise alors un script Python qui désagrège les zones de FUND en pays, et qui associe à chaque pays sa zone dans WILIAM. 
    
\end{methodbox}

La plupart des fonctions de dommage dépendent du niveau de revenu par habitant, de plusieurs manières. Le premier cas de figure est qu'elles donnent un niveau de dommage qui est exprimé en proportion du PIB. On a alors un niveau de dommage absolu qui est plus grand dans les régions plus riches, puisque le PIB est lui-même plus grand. Ce point est essentiel, en particulier dans les modèles d'optimisation. En effet, ces modèles cherchant à trouver la solution la moins couteuse, ils vont être beaucoup plus sensibles aux dommages dans les pays ayant un PIB plus important que dans les pays ayant un niveau de revenu plus faible. \emph{De facto}, ils vont chercher à minimiser les dommages dans les pays les plus riches, quitte à augmenter les dommages dans les pays les plus pauvres. \\

La deuxième manière est que la fonction de dommage intègre directement le niveau de revenu dans le calcul du niveau de dommage. Selon le signe de l'équation, cette méthode peut renforcer les effets dans les pays les plus pauvres, ou au contraire les augmenter. 

On peut finalement citer une technique permettant de monétiser des impacts non monétaires, tels que des morts ou des années d'invalidité. La technique utilisée est assez classique en économie : il s'agit de calculer la valeur d'une vie statistique, ou \emph{value of a statistical life} (VSL). Cette méthode part de l'hypothèse que la valeur de la vie dans un lieu donnée correspond à un certain multiple du niveau de revenu par habitant dans ce lieu. On peut prendre en exemple la VSL du modèle FUND, qui prend la forme suivante : 

\begin{equation}
    VSL_{t, r} = \alpha (\frac{y_{t,r}}{y_0})^\epsilon
\end{equation}
où $t$ désigne l'année, $r$ désigne la région, $\alpha$ et $\epsilon$ des paramètres permettant de calibrer la fonction, $y_{t,r}$ le revenu par habitant dans la région $t$ à l'instant $r$, et $y_0$ un revenu de référence.  \\

Ce choix de modélisation pose de nombreuses questions. 
D'abord, d'un point de vue pragmatique. Les pays les plus pauvres sont susceptibles d'être les pays les plus impactés par le changement climatique, d'une part par une exposition plus grande à des phénomènes extrêmes, et d'autre part par une situation de pauvreté préexistante qui fragilise la résilience. 
Ensuite, pour des raisons morales. Le principe de responsabilité commune mais différenciée sur le changement climatique, qui préside le régime climatique depuis sa formation, instaure une distinction claire entre les pays des Nords, qui ont bénéficié de l'émission de carbone pendant des décennies pour leur développement, et les pays des Suds, dont le poids historique est relativement limité. On pourrait penser qu'il est souhaitable de pénaliser grandement les impacts du changement climatique dans les pays des Suds, du fait de cette responsabilité moindre. 
Enfin,  on peut aussi envisager une perspective de justice sociale pour traiter de ce sujet. On peut par exemple imaginer que les dommages sur les plus pauvres, touchant des populations déjà fragiles, sont particulièrement impactants. Il pourrait être dès lors notre responsabilité de limiter ces impacts, à la manière du Maximin de Rawls. 

Notre propos ici n'est pas de défendre l'une ou l'autre de ces positions. Chacune défend un objectif et un système normatif différent. Elles ont toutes leurs arguments et leurs travers, et il n'est pas question d'affirmer que l'une d'elle est la seule manière possible de concevoir le problème. Il s'agit même plutot de l'inverse : montrer qu'une multitude de choix de modélisation existent, et que leurs implications sont radicalement différentes. 

En revanche, nous argumentons qu'il y a nécessairement, dans les pratiques de modélisation, le choix de l'une ou l'autre de ces conceptions.  Nous cherchons dès lors à comprendre les effets de ce choix sur le niveau de sortie du modèle, en appliquant un pondérateur géographique (voir encadré méthodologique) en sortie des fonctions de dommage. Le rôle de ce coefficient est précisément de  rendre visible l'existence de ce choix, et de permettre aux utilisateurs de varier les paramètres. 

\begin{methodbox}[Définition du pondérateur géographique]
Nous observons la forme de la valeur d'une vie statistique, développée dans FUND. Cette expression est une bonne référence, car : 

\begin{itemize}
    \item il s'agit d'une pratique courante
    \item elle représente un phénomène dont on pourrait penser qu'il ait la même valeur partout (en l'occurrence, la mort)
    \item 
\end{itemize}
\blog{https://damage-functions-modeling.readthedocs.io/en/latest/3_modelling/ethical_coef.html}

Cette expression permet de comparer un même phénomène (la mort), dans des contextes dans lesquels le revenu est différent. Elle est donc adaptée pour représenter un même phénomène (un niveau de dommage, au sens physique) dans un système de comptabilité différent (en l'occurrence monétaire). 

Nous l'adaptons ainsi : 

\begin{itemize}
    \item les variations du coefficient $\alpha$ permettent de faire varier le sens et l'intensité de la relation entre niveau de revenu et niveau de dommage comptabilisé
    \item les variations de $y_0$ permettent de faire varier la limite entre les pays considérés comme riches et les pays considérés comme pauvres
    \item les variations de $\epsilon$ permettent de faire varier la convexité de la relation, c'est-à-dire à quel point les valeurs pour les différents pays vont être différentes. 
\end{itemize}

On peut retrouver une représentation graphique de ces coefficients dans la figure \ref{fig:ponderateur_selon}.
\vspace{2cm}

\centering
%\includegraphics[width=0.75\linewidth]{figures/coef.png}

\end{methodbox}
\begin{methodbox}[Exécution des différents runs]
L'exécution des runs est automatisée à l'aide d'un script Python et de PySD. \blog{https://damage-functions-modeling.readthedocs.io/en/latest/3_modelling/run.html} Les résultats sont ensuite stockés dans des objets NetCDF4. 

    
\end{methodbox}

\subsection{Modèle économétrique}

\subsubsection{Au niveau régional}


On construit un modèle économétrique dont la forme générale est la suivante : 


\begin{align}
\label{eq:modele}
    \text{log(dommage)} = & \ \beta_0  + \underbrace{\beta_1 \cdot \text{temperature}}_\text{Variables physiques}  + \underbrace{\beta_2 \cdot \text{equation}}_\text{Variables méthodologiques} \\
    & + \underbrace{ \beta_3 \cdot \text{pondérateur géographique} + }_\text{variables éthiques}  + \epsilon
    \end{align}


Les résultats sont plus probants lorsque l'on passe le niveau de dommage au log. Ceci n'a rien d'étonnant. En effet, le modèle a été construit ainsi. En repartant de la manière dont le niveau de dommage est calculé et implémenté dans le dommage, on peut obtenir des équivalences entre ces différentes équations : 

\begin{align*}
& D_{t,r} = f_{dommages} \cdot GDP \cdot \text{pondérateur géographique}\\
\iff & D_{t,r} = f(\text{temperature}, \text{ autres facteurs})_{t,r} \cdot GDP_{t,r} \cdot \text{pondérateur géographique} \\
\iff  & D_{t,r} = \text{temperature}_{t,r}^{\beta_1} \cdot GDP_{t,r}^{\beta_2} \cdot \text{coef}^{\beta_3} \\
\iff & log(D_{t,r}) = log(\text{temperature}_{t,r}^{\beta_1} \cdot GDP_{t,r}^{\beta_2} \cdot \text{coef}^{\beta_3}) \\
\iff & log(D_{t,r}) = \beta_1 \cdot log(\text{temperature}_{t,r}) + \beta_2 \cdot log(GDP_{t,r}) + \beta_3 \cdot log(\text{coef})
\end{align*}
$D_{t,r}$ désigne le niveau de dommage; $f_{dommages}$ désigne la fonction de dommage, qui donne un premier niveau de dommage en fraction du PIB, généralement selon la température.  \\

On obtient ainsi quasiment la forme du modèle économétrique. Ceci peut interroger : en effet, que démontrons-nous, si ce n'est la validité empirique de ces équivalences ? En effet, le pouvoir de démonstration est faible. De toute façon, la causalité ne nous intéresse pas ici :  puisque l'on a \emph{construit} le modèle, on sait de façon certaine la causalité; c'est même une définition. Par ailleurs, on a un contrôle total sur les facteurs qui influencent nos données. En effet, dans les travaux empiriques, les données sont issues de collectes. Elles font l'objet de nombreux biais, et surtout sont influencées par de nombreux facteurs autres que ceux mesurés par le modèle. Ici, on construit ces données, et on peut donc savoir précisément quel facteur influence nos résultats. \\

L'objectif ici n'est pourtant pas de montrer une causalité, mais bien de mesurer l'ampleur de cette variation, et de pouvoir comparer les impacts des différents facteurs. Les régressions permettent de synthétiser ces variations en des coefficients uniques, \emph{ceteris paribus}.

L'objectif est de quantifier l'impact relatif des variables physiques, méthodologiques et éthiques. On réalise ensuite cinq régressions linéaires, qui sont des variations du modèle présenté plus haut. 


On a d'abord une régression simple du niveau de dommage selon la température : 

\begin{align}
\text{log(dommage)} = & \ \beta_0  + \beta_1 \cdot \text{temperature}  + \epsilon
\end{align}

Cette première étape nous permet de comparer les résultats de nos modèles plus complexes avec un modèle plus simple, pour s'assurer que prendre en compte les autres facteurs apporte effectivement un pouvoir explicatif complémentaire.  \\

On ajoute ensuite le pondérateur géographique, sans tenir compte à ce stade de la forme de l'équation ni contrôler par la région. 

\begin{align}
\text{log(dommage)} = & \ \beta_0  + \beta_1 \cdot \text{temperature}  + \beta_2 \cdot \text{pondérateur géographique} + \epsilon
\end{align}

On cherche maintenant à observer l'effet de la forme de la fonction de dommage : 

\begin{align}
\text{log(dommage)} = & \ \beta_0  + \beta_1 \cdot \text{temperature}  + \beta_3 \cdot \text{equation} + 
 \beta_2 \cdot \text{pondérateur géographique}  + \epsilon
\end{align}

On essaie également de contrôler les différences régionales en tenant compte de celles-ci grâce à une dummy. 

\begin{align}
\text{log(dommage)} = & \ \beta_0  + \beta_1 \cdot \text{temperature}  + \beta_2 \cdot \text{pondérateur géographique} + \beta_3 \cdot \text{région} + \epsilon
\end{align}

Finalement, le modèle le plus complet prend en compte à la fois la température (variable physique), l'équation (variable méthodologique) et le pondérateur géographique (variable éthique), tout en contrôlant par les régions. 

\begin{align}
\text{log(dommage)} = & \ \beta_0  + \beta_1 \cdot \text{temperature}  + \beta_2 \cdot \text{pondérateur géographique} + \beta_3 \cdot \text{région} + \beta_4 \cdot \text{équation} + \epsilon
\end{align}

\subsubsection{Au niveau mondial}

On poursuit l'analyse en agrégeant les données au niveau mondial. Cette démarche est plus proche de ce qu'il se passe dans les modèles d'optimisation tels que ceux utilisés pour le \gls{cout social du carbone}. Cette agrégation est une somme de tous les dommages pour chaque $ (\text{exposant}, \text{constante}) $, c'est-à-dire $ (\text{année}, \text{run}) $. On évalue ainsi le modèle suivant : 

\begin{align}
\text{log(dommage)} = & \ \beta_0  + \beta_1 \cdot \text{temperature}  + \beta_2 \cdot \text{log(coefficient)} + \beta_3 \cdot \text{log(constante)} + \beta_4 \cdot \text{équation} + \epsilon
\end{align}


\subsubsection{Évaluation de l'estimateur} \textcite{wooldridge_introductory_2016} propose cinq critères pour un bon estimateur. D'abord, on doit écrire notre modèle économétrique sous la forme d'une combinaison linéaire des variables explicatives. C'est bien le cas ici (voir équation \ref{eq:modele}). Ensuite, l'échantillon doit être aléatoire. Dans notre cas, nous avons fait varier de manière aléatoire les paramètre du modèle; on observe néanmoins des schémas dans la distribution des valeurs des niveaux de dommage; il est donc possible que cet échantillon ne soit pas tout à fait aléatoire. Cela s'expliquerait par exemple par des différences systématiques liées à la région (on observe d'ailleurs que lorsque l'on contrôle par la région, cet effet disparait).  Il faut ensuite avoir une variation des échantillons, ce qui est notre cas. Puis, il faut que l'espérance conditionnelle des termes d'erreur soit nulle. On observe bien cela ici. En revanche, les tests d'homoscédasticité montrent qu'il y a de l'hétéroscédasticité.  Ces différentes analyses sont développées sur le site \blog{https://damage-functions-modeling.readthedocs.io/en/latest/3_modelling/regprep.html}.

\begin{figure}
    \centering
    \includegraphics[width=\linewidth]{results/slr_4_2.png}
    \legende{Espérence conditionnelle des termes d'erreurs}{Cette figure représente la distribution des espérences des termes d'erreurs selon plusieurs  des conditions sur la variable explicative $x$. Cela signifie qu'il n'y a pas trop d'erreur systématique selon la valeur  de la variable explicative. On remarque néanmoins que la forme n'est pas symmétrique, avec des erreurs fortement négatives. }
    \label{fig:slr_4}
\end{figure}

L'échantillon ne respect pas les cinq critères de Wooldridge. De ce point de vue, on peut penser que ce n'est pas un très bon estimateur, et qu'il faut chercher à améliorer notre modèle. Cependant, nous ne cherchons pas ici à avoir un pouvoir explicatif, mais bien à avoir une mesure quantitative d'un phénomène dont on sait qu'il existe, puisque nous l'avons défini ainsi. 


\begin{methodbox}
On utilise ici le modèle WILIAM. Il s'agit d'un modèle open source, donc il est assez facile de le répliquer, modifier et distribuer. Le code source est disponible sur GitHub. On réalise un fork du code source c'est-à-dire une branche de code. Notre branche de code devient un projet autonome sur lequel on peut travailler de manière semi-indépendante du projet. En effet, les modifications du projet WILIAM ou celles réalisées ici ne s'affecteront pas, à moins que l'on push notre code vers le code principal, ou que l'on pull les nouvelles modifications du code principal vers notre branche. Ces deux opérations peuvent se faire sous supervision, pour s'assurer que l'on n'interagit pas avec différentes parties de notre code, ce qui risquerait de fausser nos résultats. \blog{https://damage-functions-modeling.readthedocs.io/en/latest/3_notebooks/spatial_temporal_equity.html} \\

Dans cette branche, on modifie le code pour qu'il représente les fonctions de dommage. On modélise ainsi plusieurs formes de fonctions de dommage, issues de la revue de littérature évoquée plus haut. On fait tourner le modèle avec ces différentes fonctions de dommage, et en faisant varier aléatoirement les différents paramètres : taux d'actualisation, les différents paramètres qui entrent en compte dans le modèle. \\

On récupère les résultats et on procéde à des analyses économétriques sur les résultats pour voir quels sont les paramètres qui ont le plus influencé les résultats. 

\end{methodbox}

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{illustrations/rect1.png}
    \legende{Méthodologie de la comparaison des modèles. (SVG)}{On utilise le modèle open-source WILIAM. Celui ci est composé de différents modules, dont un module représentant les dommages (représenté ici en rouge). On identifié les fonctions de dommage d'autres modèles (DICE, FUND et DEFINE). On les isole, et on les implémente dans le modèle WILIAM. On a alors un nouveau modèle, qui contient simultanément plusieurs manières de représenter les dommages. On connait la distribution de certains paramètres, et on cherche à voir l'effet de cette variation sur les résultats du modèle. On réalise des scénarios, qui sont des combinaisons de tirage aléatoire des variables. Le modèle est executé avec chaque scénario, de nombreuses fois. Tous ces \textit{runs} forment une grande base de donnée, sur laquelle on va réaliser une étude économétrique.}
    \label{fig:methodo-simu}
\end{figure}

\subsection{Limites et contraintes}

Plusieurs limitations doivent être soulignées. 

\paragraph{Transposition dans un autre modèle} D'abord, on utilise les fonctions de dommage de différents modèles dans le modèle WILIAM. Cela permet d'avoir les mêmes conditions pour toutes les fonctions de dommage. Ceci étant dit, les fonctions ne sont plus dans leur milieu d'origine. Ceci pose deux problèmes. D'abord, les fonctions peuvent avoir été calibrées pour fonctionner correctement dans certaines conditions de fonctionnement de température, et pas au-delà; et ces conditions peuvent ne pas être atteintes dans WILIAM. Cela est notamment vrai pour toutes les variables qui nécessitent une calibration, par exemple celles où la population entre en jeux. Une population différente peut aboutir à une fonction de dommage qui est différente. Ensuite, il y a un grand risque d'erreur de transcription. En effet, les variables peuvent avoir les mêmes noms mais ne pas désigner la même chose précisement ou ne pas être calculée de la même manière; ou encore, la documentation d'origine peut ne pas être claire sur les caractéristiques précises d'une variable (notamment, le niveau de désagrégation). On peut néanmoins considérer que ce n'est pas une limitation très forte. En effet, nous nous intéressons ici à la \emph{relation} entre les hypothèses et le niveau de dommage, et pas au niveau de dommage \emph{en soi}. Ainsi, une mauvaise calibration risque de donner des valeurs trop faibles ou trop élevées, mais n'a pas d'effet sur la relation en soi. Par ailleurs, ces fonctions sont justement présentées comme des relations liant les phénomènes climatiques à un niveau de dommage. Si changer de modèle affecte grandement la validité de la relation, alors on peut interroger la validité de la relation dans son ensemble. 

\paragraph{Colinéarité} Le problème majeur de cette technique est que les données analysées ont été produites dans la perspective de cette analyse. Ainsi, il est possible que le résultat de l'analyse  reflète que les hypothèses et les variations qui ont été volontairement ajoutées au modèle. En particulier, le niveau de dommage dépend beaucoup de la valeur du coefficient d'éthique spatial, qui est lui-même construit pour l'expérience. 



\section{Résultats}

\subsection{Par région}

\begin{table}
    \centering
     \resizebox{\textwidth}{!}{\input{results/regression_1}}
     \legende{Régressions par région}{Résultats des régressions du logarithme du niveau total de dommages, zone par zone, en fonction du changement de température, du pondérateur géographique, et de la forme de la fonction de dommage. Chaque colonne correspond à une analyse, chaque ligne à une variable. La variable expliquée est le log du niveau de dommage de chaque pays. Clé de lecture : le fait d'avoir une fonction de dommage de la forme DICE diminue le niveau de log\_dommage de 19.6\% par rapport à la fonction de DEFINE, toute autre chose étant égale par ailleurs.}
     \label{tab:reg_region}

\end{table}

Les résultats du premier jeu de régression linéaires sont présentées dans la table \ref{tab:reg_region}. Cinq variables y sont présentées : le niveau de changement de température par rapport à la période préindustrielle (en degré Celsius); la valeur du pondérateur géographique, passée au log; la présence ou non de dummy régionales, qui permettent de contrôler par zone; et enfin des dummy qui indique si la fonction de dommage est de la forme DICE ou WITNESS. Ces deux dernières valeurs sont à comparer \enquote{hello} à la valeur 'par défaut', qui est celle de DEFINE. \\






Tous les coefficients sont significatifs au seuil de 0.01. Ceci reflète le fait que les variables sont construites, et donc expliquées grandement par les variables explicatives prises en compte. 

\blog{https://damage-functions-modeling.readthedocs.io/en/latest/3_modelling/regressions.html}

La première régression est selon le changement de température uniquement. Elle sert d'élément de comparaison, pour s'assurer qu'ajouter les autres variables explicatives à l'analyse permet en effet d'augmenter le pouvoir explicatif du modèle. Le $R^2$ est en effet faible, à 0.315, ce qui explique que le niveau de changement de température explique 31\% des variations du niveau de dommage, passé au logarithme. Le coefficient est de 2.8, ce qui veut dire qu'une augmentation de température de 1 \textdegree de la température résulte en une augmentation du log de dommage de 2.8, toute autre chose étant égale par ailleurs. C'est très important, puisque pour revenir au niveau de dommage pur il faut passer par l'exponentielle : $e^{2.8}=16.44$. Une augmentation de 1 \textdegree de la température est liée à une augmentation de 1544\% du niveau de dommage absolu. \\



En ajoutant le pondérateur géographique et la forme des fonctions de dommage dans le modèle, on augmente le pouvoir explicatif pour obtenir un $R^2$ de 0.49. C'est plus, mais moins que ce que l'on attendrait. \\

À l'inverse, si on a la température, le pondérateur géographique et les dummy régionales, on obtient un $R^2$ de 0.95, ce qui est beaucoup plus important. On obtient une valeur similaire pour la relation log-dommage / température. Cependant, l'écart-type des valeurs est plus petit, signifiant que ce coefficient est plus fiable. On a une relation d'environ 1 pour la relation log-damage / log-coef. C'est tout à fait cohérent avec la manière dont a été construite la variable $damage$. Cela veut dire qu'une augmentation de 1\% de la valeur de ce coefficient résulte en une augmentation de 1\% du niveau absolu de dommage. \\


Enfin, en prenant en compte toutes les variables explicatives, on obtient un $R^2$ de 0.96. Cela veut dire que 96\% des variations de log\_damage sont expliquées par les variables explicatives prise en compte dans le modèle. On peut ainsi dire qu'il n'y a pas ou peu d'autres facteurs qui expliquerait des variations du niveau de dommage. Par ailleurs, le fait qu'ajouter des dummy régionales augmente tant le pouvoir explicatif du modèle laisse penser que parmi les facteurs influençant le niveau de dommage, certains, même non captés explicitement par notre modèle, sont étroitement liés à la région. Ils peuvent être de différents ordres (par exemple, le PIB). Les coefficients pour l'augmentation de température et pour le pondérateur géographique sont similaires aux autres modèles. On obtient également des valeurs pour les formes des fonctions de dommage. Ainsi, avoir une forme de DICE diminue le niveau de dommage absolu de 17.8\% ($1 - e^{-0.196}= 1 - 0.822 = 0.178$) par rapport à une fonction de dommage de la forme DEFINE. De la même manière, une fonction de dommage de la forme WITNESS correspond à une augmentation du niveau absolu de dommage de 42\% ($ e^{0.35} = 1.42$). \\

\subsection{En agrégeant au niveau mondial}

\begin{table}
    \centering
    \resizebox{\textwidth}{!}{\input{results/regression_global}}
    \legende{Résultats des régressions aggrégées par pays}{La variable expliqué est le logarithme du niveau total de dommage, par année. Clé de lecture : augmenter de 1\% la valeur de la constante de normalisation correspond à une diminution de 68\% du niveau de dommage. }
    \label{tab:reg_glob}
\end{table}

La table \ref{tab:reg_glob} présente les résultats d'un deuxième jeu de régressions. Ici, nous avons regroupé les résultats par année et par run de simulation. En d'autres termes, ce sont les mêmes résultats que la table \ref{tab:reg_region}, mais les valeurs sont la somme de tous les dommages mondiaux au niveau global, et plus par région. Cette approche permet de décomposer le pondérateur géographique en deux : l'exposant et la constante de normalisation. Par ailleurs, cette échelle permet d'être plus proche des conditions dans lesquelles sont calculés des valeurs agrégées des impacts du changement climatique, telles que le Coût Social du Carbone. Les résultats des trois modèles ont des $R^2$ importants ($>0.8$), ce qui reflète le fait que les différences régionales disparaissent dans l'agrégation au niveau mondial. \\

On obtient des résultats similaires entre les trois modèles, avec des $R^2$ qui augmentent légèrement à mesure qu'on ajoute des variables explicatives. Nous nous concentrons ici sur les résultats du modèle 3. La relation entre l'augmentation de température et le niveau de dommage est plus importante encore que dans les régressions précédentes, puisqu'elle est de 4.11. On obtient des valeurs très similaires pour l'effet des fonctions de dommage. Une variation de l'exposant du pondérateur géographique de 1\% explique une variation de 18,8\% du niveau total de dommage. De la même manière, une augmentation de la constante de normalisation de 1\% correspond à une diminution de 68\% du niveau de dommage total. 


\section{Discussion}







\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{results/cartogramme_3.png}
    \legende{Carte en anamorphose selon le niveau de dommage}{L'espace est déformé pour que la surface de chaque zone soit proportionnelle à la valeur absolue des dommages subis. La carte du centre représente l'ensemble de l'échantillon. La carte du haut représente uniquement les runs où il y a un coefficient > 1 et une constante > 20000 (scénario où l'on exacerbe les inégalités). La carte du bas représente uniquement les runs où il y a un coefficient < 1 et une constante < 15000 (scénario ou on pénalise fortement les dommages sur les plus faibles revenus). Ces cartes ont une valeur avant tout heuristique : c'est pour cette raison qu'il n'y a pas d'échelle. L'objectif est avant tout de visualiser l'effet qu'ont les distributions de nos paramètres sur la distribution des dommages comptabilisés.  La disparition de l'UE27 n'est pas volontaire et ne doit pas être interprétée. }
    \label{fig:anamorphose}
\end{figure}

%\begin{figure}
   % \centering
    %\includegraphics[width=0.5\linewidth]{}
    %\legende{Les dommages selon la manière de comptabiliser le revenu par habitants}{}
    %\label{fig:carte1}
%\end{figure}


%\begin{figure}
   % \centering
    %\includegraphics{}
    %\legende{Coûts des dommages selon la fonction de dommage incluse dans le modèle WILIAM.}{Graphiques représentant la valeur totale des dommages dans le modèle WILIAM selon la fonction de dommage. Les couleurs représentant le modèle d'origine de la fonction de dommage; la ligne pleine la médiane, la zone grisée les valeurs interquartiles.}
    %\label{fig:simu}
%\end{figure}



\subsection{Interprétation des résultats}

%Que signifient vos résultats par rapport à vos hypothèses ? Quelles conclusions pouvez-vous en tirer ? 

Les résultats par région (voir table \ref{tab:reg_region}) permettent de mettre en évidence le rôle que joue chacun des trois types de variables explicatives détaillées plus haut : physique, méthodologique et éthique. 
Sans surprise, les variables climatiques jouent un rôle majeur dans la détermination du niveau de dommage. Ici, elles sont incarnées par l'augmentation de la température moyenne par rapport au niveau préindustriel. Ce résultat était attendu, et est cohérent avec les hypothèses. En effet, l'augmentation de la température est un des canaux principaux des effets du changement climatique. Par ailleurs, la plupart des fonctions de dommage sont des fonctions de la température. 
Les variables méthodologiques, ici représentées par le choix de la fonction de dommage, jouent également un rôle important. Ainsi, une fonction type DICE (voir \ref{eq:df_dice2023}) produira, toute autre chose étant égale par ailleurs, des dommages 17\% plus faible que DEFINE (voir \ref{eq:DEFINE}), tandis qu'une équation type de WITNESS (voir \ref{eq:WITNESS}), qui prend en compte un niveau plus élevé de dommage suite au passage d'un tipping point, produira des dommages 42\% plus élevés. 
En guise de variable éthique, nous avons choisi de travailler avec le pondérateur géographique. Les résultats ici ne prêtent pas spécifiquement à interprétation, puisqu'ils sont principalement le reflet de la manière dont $log\_damage$ a été construite. \\

Les résultats au niveau global (voir \ref{tab:reg_glob}) permettent d'interpréter plus précisement le rôle de chacun des composants de ce pondérateur géographique. Une variation de l'exposant du pondérateur géographique de 1\% explique une variation de 18,8\% du niveau total de dommage. C'est important, puisque celui-ci est défini selon une loi uniforme normale de moyenne 0 et d'écart-type 1.

De la même manière, l'effet de la constante de normalisation du niveau de revenu de 1\% correspond à une diminution de 68\% du niveau de dommage
total. Cette constante est calibrée selon une loi uniforme sur l'intervalle 10000-50000. La variation de cette constante peut s'interpréter comme une variation de ce qui est considéré comme un niveau de revenu moyen. En effet, le pondérateur géographique va favoriser les pays dont le revenu par habitant est inférieur à cette valeur en augmentant la manière dont les dommages sont comptabilisés, tout en atténuant le poids des dommages des pays plus riches. Ainsi, choisir une valeur plus grande de cette constante de normalisation tend à gommer les inégalités entre les pays. 

\begin{figure}[htbp]
    \centering
    \begin{minipage}{0.5\textwidth}
        \centering
        \includegraphics[width=\linewidth]{results/exponent.png} % Remplacez par le chemin de votre image
        \subcaption{Valeur du pondérateur selon l'exposant}
        \label{fig:coef}
    \end{minipage}%
    \hfill
    \begin{minipage}{0.5\textwidth}
        \centering
        \includegraphics[width=\linewidth]{results/norm_constant.png} % Remplacez par le chemin de votre image
        \subcaption{Valeur du pondérateur selon la constante}
        \label{fig:cons}
    \end{minipage}%
    \legende{Valeur du pondérateur selon la valeur de l'exposant et de la constante de normalisation}{L'axe des ordonnées représente la valeur du pondérateur géographique. Ces deux figures permettent de se représenter l'effet des variations des deux paramètres (exposant à gauche, constante de normalisation à droite) sur la valeur du pondérateur géographique. A gauche, on fixe une constante de normalisation à 25000, et faison varier l'exposant suivant une loi normale (la valeur de l'exposant est représentée par la couleur : plus c'est violet, plus la valeur est élevée). A droite, on fixe l'exposant à 1, et on fait varier la constante de normalisation en suivant une loi uniforme sur $[10000, 50000]$. En pratique, les deux sont affectés aléatoirement à chaque \emph{run}. Clé de lecture : chaque ligne correspond à un fonction permettant d'avoir le pondérateur géographique. Elle correspond à un tirage particulier du couple $(\text{exposant}, \text{constante})$. Afin d'obtenir le pondérateur géographique d'une région, il faut choisir une courbe, lire le revenu par habitant en abscisse, puis lire la valeur du pondérateur géographique sur l'axe des ordonnées. Pour avoir celle d'une autre région dans les même conditions, il faut renouveller l'opération en utilisant la même courbe. }
    \label{fig:ponderateur_selon}
\end{figure}


\subsection{Comparaison avec la littérature}

Ces résultats sont en cohérence avec des acquis de la littérature. 

D'abord, on retrouve une relation très importante entre le changement de température et le niveau de dommage. Malgré l'introduction du pondérateur géographique dans le modèle, cette relation reste très significative et d'une amplitude très importante. \\

Nous retrouvons également que le choix du modèle influence grandement le résultat. C'est cohérent avec la littérature, qui montre qu'une partie importante des variations des résultats des modèles provient du choix du modèle lui-même. On peut par exemple citer \textcite{gillingham_modeling_2015, gillingham_modeling_2018}, qui montrent cette sensibilité. 

Enfin, nous montrons que les variables éthiques jouent un grand rôle dans le niveau de dommage comptabilisé.

La valeur du taux d'actualisation est une discussion classique de ce sujet. Nous complétons ici la question de l'équité temporelle par l'équité spatiale. 

On retrouve des résultats allant dans le sens de \textcite{dennig_inequality_2015}, qui montrent qu'une prise en compte des effets différenciés des impacts du changement climatique selon le niveau de revenu permet d'aboutir à un coût social du carbone très différent. Nous retrouvons ainsi des résultats similaires pour les variations spatiales et interrégionales. 


\subsection{Implications pratiques}

Ces résultats montrent le rôle crucial qu'ont les hypothèses éthiques dans la détermination du niveau de dommage. Elles appellent à la plus grande prudence s'agissant de déterminer un niveau \emph{optimal} de dommages. Il serait en effet très sensible à la distribution de ceux-ci et à la pondération des dommages selon les régions. Il semble donc que l'utilisation de telles fonctions de dommages nécessite d'une part une discussion permettant d'établir de manière juste (avec toute la difficulté qu'un tel terme suppose) une comptabilité des dommages; d'autre part, une transparence importante de ces hypothèses. Loin d'être un enjeu technique réservé aux seuls spécialistes de la modélisation, ces questions sont des questions éminemment politiques. Nous avons montré ici qu'elles jouent un rôle déterminant dans l'estimation du niveau de dommage. 


\subsection{Perspectives futures}
% Quelles recherches supplémentaires pourraient être nécessaires pour approfondir vos découvertes ou explorer des questions connexes ?

De nombreuses pistes pour de la recherche ultérieure peuvent être citées. \\

D'abord, solidifier les outils. Comme nous l'avons évoqué ou l'évoquerons à de multiples reprises, les modèles sont des outils difficiles à prendre en main, avec des fonctionnements et des documentations protéiformes. Il est donc évident que de nombreuses erreurs de transcription, paramétrisation ou compréhension se soient glissées dans le code. Une première étape serait donc de chercher à augmenter la fiabilité du code source utilisé pour l'expérience. Par exemple, l'implémentation des fonctions de dommage de FUND n'ont pas pu aboutir, car elles donnaient des résultats trop imprécis. On pourrait par exemple contribuer au package PySD, pour permettre d'automatiser la création de documentation à partir du modèle. Un tel outil permettrait d'écrire automatiquement les fonctions de WILIAM selon leurs inputs et leurs outputs, et d'écrire directement de la documentation lisible par des humains. Par exemple, elle permettrait d'écrire des équations \LaTeX à partir du code source, ce qui permettrait de s'assurer que le code source et la documentation sont en adéquation. On pourrait pour cela s'inspirer du fonctionnement de ReadTheDocs. \\

Nous avons cité des études s'intéressant à l'équité générationnelle, à l'équité sociale, et nous nous sommes penchés sur l'équité spatiale. Il pourrait être intéressant d'implémenter simultanément ces différentes approches, pour évaluer leur influence respective sur les résultats du modèle. \\

De plus, nous n'avons implémenté que trois fonctions de dommage. Nous pourrions continuer à implémenter d'autres fonctions, et notamment des fonctions ne prenant pas en compte l'aspect monétaire, mais par exemple prenant en compte l'aspect énergétique ou matériel des dommages. \\

Enfin, il serait intéressant de développer un outil permettant à un utilisateur non expérimenté de varier ses paramètres, afin d'apporter ces questions dans un débat qui dépasse la communauté de la modélisation. 